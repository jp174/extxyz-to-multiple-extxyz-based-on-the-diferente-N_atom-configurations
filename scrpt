from collections import defaultdict

input_file = "ElladBTadmorDataBasis.xyz"   # <-- cambia esto
output_prefix = "frames"

frames_by_natoms = defaultdict(list)

with open(input_file, "r") as f:
    lines = f.readlines()

i = 0
total_frames = 0

while i < len(lines):
    line = lines[i].strip()

    # Detecta línea con número de átomos
    if line.isdigit():
        natoms = int(line)
        frame = lines[i : i + natoms + 2]
        frames_by_natoms[natoms].append(frame)

        total_frames += 1
        i += natoms + 2
    else:
        i += 1  # por si hay basura rara

# Escritura de archivos
for natoms, frames in frames_by_natoms.items():
    output_file = f"{output_prefix}_{natoms}_atoms.extxyz"
    with open(output_file, "w") as f:
        for frame in frames:
            f.writelines(frame)

    print(f"✔ {len(frames)} frames con {natoms} átomos → {output_file}")

print("\nResumen final:")
print(f"Total de frames encontrados: {total_frames}")
print(f"Archivos generados: {len(frames_by_natoms)}")
